"0","# load libraries"
"0","library(tidyverse)"
"0","library(ggrepel)"
"0","library(ggthemes)"
"0","library(dslabs)"
"0","data(murders)"
"0",""
"0","# define the intercept"
"0","r <- murders %>%"
"0","    summarize(rate = sum(total) / sum(population) * 10^6) %>%"
"0","    .$rate"
"0","    "
"0","# make the plot, combining all elements"
"0","murders %>%"
"0","    ggplot(aes(population/10^6, total, label = abb)) +"
"0","    geom_abline(intercept = log10(r), lty = 2, color = ""darkgrey"") +"
"0","    geom_point(aes(col = region), size = 3) +"
"0","    geom_text_repel() +"
"0","    scale_x_log10() +"
"0","    scale_y_log10() +"
"0","    xlab(""Population in millions (log scale)"") +"
"0","    ylab(""Total number of murders (log scale)"") +"
"0","    ggtitle(""US Gun Murders in 2010"") +"
"0","    scale_color_discrete(name = ""Region"") +"
"0","    theme_economist()"
"0",""
