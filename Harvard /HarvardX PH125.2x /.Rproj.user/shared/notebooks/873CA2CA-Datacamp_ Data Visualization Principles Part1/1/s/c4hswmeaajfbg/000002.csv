"0","library(dplyr)"
"0","library(ggplot2)"
"0","library(dslabs)"
"0","library(RColorBrewer)"
"0","data(us_contagious_diseases)"
"0","the_disease = ""Smallpox"""
"0",""
"0","dat <- us_contagious_diseases %>%"
"0","   filter(!state%in%c(""Hawaii"",""Alaska"") & disease == the_disease & weeks_reporting >= 10) %>%"
"0","   mutate(rate = count / population * 10000) %>%"
"0","   mutate(state = reorder(state, rate))"
"0",""
"0","avg <- us_contagious_diseases %>%"
"0","  filter(disease==the_disease) %>% group_by(year) %>%"
"0","  summarize(us_rate = sum(count, na.rm=TRUE)/sum(population, na.rm=TRUE)*10000)"
"0",""
"0","dat %>% ggplot() +"
"0","  geom_line(aes(year, rate, group = state),  color = ""grey50"", "
"0","            show.legend = FALSE, alpha = 0.2, size = 1) +"
"0","  geom_line(mapping = aes(year, us_rate),  data = avg, size = 1, color = ""black"") +"
"0","  scale_y_continuous(trans = ""sqrt"", breaks = c(5,25,125,300)) + "
"0","  ggtitle(""Cases per 10,000 by state"") + "
"0","  xlab("""") + "
"0","  ylab("""") +"
"0","  geom_text(data = data.frame(x=1955, y=50), mapping = aes(x, y, label=""US average""), color=""black"") + "
"0","  geom_vline(xintercept=1963, col = ""blue"")"
